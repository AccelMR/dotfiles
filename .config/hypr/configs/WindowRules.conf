########################################################################################
# HYPRLAND WINDOW RULES - TAG-BASED CONFIGURATION (v3 FIXED)
########################################################################################

monitor=eDP-1,2880x1920@120,0x0,1.5

# Utility: Floating, centered, standard size
windowrule {
    name = utility-rule
    match:tag = utility
    float = on
    center = on
    size = 1000 700
}

# WebApps: Floating, specific size and position
windowrule {
    name = webapp-rule
    match:tag = webapp
    float = on
    size = 30% 50%
    move = 2% 5%
}

# Media: Floating and centered
windowrule {
    name = media-rule
    match:tag = media
    float = on
    center = on
}

# System: Opacity and visual tweaks
windowrule {
    name = transparent-rule
    match:tag = transparent
    opacity = 0.9 0.8
}

# Launchers: Floating, centered, and visual effects
windowrule {
    name = launcher-rule
    match:tag = launcher
    float = on
    center = on
    stay_focused = on
    dim_around = on
    opacity = 0.95 0.90
}

# --- TAG ASSIGNMENTS (Matching) ---
# Assign +launcher tag to wofi and rofi
windowrule = match:class ^(wofi|Rofi)$, tag +launcher

# Assign +utility tag to system tools
windowrule = match:class (pavucontrol|org.pulseaudio.pavucontrol|nm-connection-editor|blueman-manager|corectrl|nwg-look|qt5ct|qt6ct|yad|gnome-system-monitor|opensnitch|opensnitch_ui|waypaper), tag +utility

# Assign +media tag to players and viewers
windowrule = match:class (mpv|eog|qalculate-qt|io.github.Qalculate.qalculate-qt|Amberol|net.davidotek.pupgui2), tag +media

# Assign +webapp tag to specific firefox instances
windowrule = match:class (firefox-(chat.openai.com|gemini.google.com|music.youtube.com).*), tag +webapp

# Assign +transparent tag for consistent opacity
windowrule = match:class (kitty|mousepad|foot|foot-dropterm|thunar|org.kde.dolphin|VSCodium|gedit), tag +transparent


########################################################################################
# SPECIFIC OVERRIDES (Rules that need unique values)
########################################################################################

# Btop (Special terminal from bar)
windowrule = match:class ^kitty-btop$, float on, center on, size 1200 800

# Octopi
windowrule = match:class (octopi), match:title (Octopi), size 1400 996, center on

# Picture-in-Picture
# Picture-in-Picture
windowrule {
    name = pip-rule
    match:title = ^(Picture-in-picture)$
    float = on
    pin = on
    size = 30% 40.5%
    move = 69% 5%
    keep_aspect_ratio = on
    no_dim = on
    opaque = on
}

# Gaming (Lutris & Steam)
windowrule = match:class (net.lutris.Lutris.*), size 80% 85%, center on, opacity 0.95 0.85
windowrule = match:class ([Ss]team), float on


########################################################################################
# DIALOGS & POPUPS
########################################################################################

# Common floating dialogs
windowrule = float on, match:class (file_progress|confirm|dialog|download|notification|error|splash|confirmreset|zenity|org.kde.polkit-kde-authentication-agent-1)

# Browser specific popups
windowrule = float on, match:class (firefox|librewolf|chromium), match:title (Save File|Open File|.*Popup.*)
windowrule = size 1220 850, match:class (firefox), match:title (Save File|Select file)


########################################################################################
# WORKSPACE ASSIGNMENTS
########################################################################################

windowrule = workspace 1, match:class (firefox-browser)
windowrule = workspace 2 silent, match:class (net.lutris.Lutris)
windowrule = workspace 3 silent, match:class ([Ss]team)
windowrule = workspace 6, match:class (gimp-.*)
windowrule = workspace 7, match:class (org.wezfurlong.wezterm)


########################################################################################
# LAYER RULES (Waybar, Notifications, etc.)
########################################################################################

layerrule = blur on, match:namespace (waybar|fabric|swaync-control-center|swaync-notification-window)
layerrule = ignore_alpha 0, match:namespace (waybar|fabric|swaync-control-center|swaync-notification-window)
layerrule = no_anim on, match:namespace selection


########################################################################################
# GLOBAL SETTINGS
########################################################################################

windowrule = focus_on_activate on, match:class .*
windowrule = no_dim on, match:class ^(firefox)$

########################################################################################
# LAUNCHER LAYER RULES (Blur & Transparency fix)
########################################################################################
layerrule = blur on, match:namespace ^(wofi|rofi)$
layerrule = ignore_alpha 0.3, match:namespace ^(wofi|rofi)$
layerrule = animation slide, match:namespace ^(wofi|rofi)$

